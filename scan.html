<!DOCTYPE html>
<html>
<head>
  <title>Invoice Scanner</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
    .box { border: 1px solid #ccc; padding: 20px; border-radius: 12px; background: #fff; max-width: 400px; margin: auto; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    h2 { text-align: center; }
    label { font-weight: bold; }
    input, select, button { width: 100%; padding: 10px; margin: 8px 0; border-radius: 6px; border: 1px solid #ccc; }
    button { background: #4CAF50; color: white; border: none; cursor: pointer; font-size: 16px; }
    button:hover { background: #45a049; }
    .success { color: green; margin-top: 12px; text-align: center; font-weight: bold; }
    .error { color: red; margin-top: 12px; text-align: center; font-weight: bold; }
  </style>
</head>
<body>
  <div class="box">
    <h2>Invoice Scanner</h2>
    <form id="invoiceForm">
      <label>Invoice No:</label>
      <input type="text" id="invoiceNo" name="invoiceNo" readonly>

      <label>Status:</label>
      <select id="status" name="status" required>
        <option value="">--Select--</option>
        <option value="OUT">OUT</option>
        <option value="RETURNED">RETURNED</option>
      </select>

      <button type="submit">Submit</button>
    </form>

    <div id="message"></div>
  </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbyhWcenMggzMkH3bIPSrPMjCloy0TD10Ik7Y3ubfCVTRb6mpTreETAtAQkXJ9-UYg/exec";

    // Auto-fill invoiceNo from ?code= param
    const params = new URLSearchParams(window.location.search);
    const code = params.get("code");
    if (code) document.getElementById("invoiceNo").value = code;

    document.getElementById("invoiceForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const invoiceNo = document.getElementById("invoiceNo").value;
      const status = document.getElementById("status").value;

      document.getElementById("message").innerHTML = "<p>⏳ Sending data...</p>";

      fetch(`${scriptURL}?invoiceNo=${encodeURIComponent(invoiceNo)}&status=${encodeURIComponent(status)}`)
        .then(res => res.text())
        .then(text => {
          document.getElementById("message").innerHTML = `<p class='success'>✅ ${text}</p>`;
        })
        .catch(err => {
          document.getElementById("message").innerHTML = `<p class='error'>❌ Error: ${err}</p>`;
        });
    });
  </script>
</body>
</html>
