<!DOCTYPE html>
<html>
<head>
  <title>Invoice Scanner (Debug)</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .debug { background: #eee; padding: 10px; margin: 10px 0; }
  </style>
</head>
<body>
  <h2>Invoice Scanner Debug</h2>
  <div class="debug">
    <p>üîç Current URL: <span id="url"></span></p>
    <p>üì¶ code param: <span id="code"></span></p>
  </div>

  <form id="invoiceForm">
    <label>Invoice No:</label><br>
    <input type="text" id="invoiceNo" readonly><br><br>
    <label>Status:</label><br>
    <select id="status" required>
      <option value="">--Select--</option>
      <option value="OUT">OUT</option>
      <option value="RETURNED">RETURNED</option>
    </select><br><br>
    <button type="submit">Submit</button>
  </form>

  <div id="message"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const fullUrl = window.location.href;
    const code = params.get('code') || params.get('q') || params.get('barcode') || '‚Äî';

    document.getElementById('url').innerText = fullUrl;
    document.getElementById('code').innerText = code;

    if (code && code !== '‚Äî') {
      document.getElementById('invoiceNo').value = code;
    }

    document.getElementById('invoiceForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const invoiceNo = document.getElementById('invoiceNo').value;
      const status = document.getElementById('status').value;
      const scriptURL = "https://script.google.com/macros/s/AKfycbyhWcenMggzMkH3bIPSrPMjCloy0TD10Ik7Y3ubfCVTRb6mpTreETAtAQkXJ9-UYg/exec";

      document.getElementById('message').innerHTML = "‚è≥ Sending data...";

      fetch(`${scriptURL}?invoiceNo=${encodeURIComponent(invoiceNo)}&status=${encodeURIComponent(status)}`)
        .then(res => res.text())
        .then(text => {
          document.getElementById('message').innerHTML = `<span style="color:green;">‚úÖ ${text}</span>`;
        })
        .catch(err => {
          document.getElementById('message').innerHTML = `<span style="color:red;">‚ùå Error: ${err}</span>`;
        });
    });
  </script>
</body>
</html>
